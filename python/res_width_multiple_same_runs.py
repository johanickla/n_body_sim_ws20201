import sys
sys.path.append('C:/Users/hannes/Documents/GitHub/n_body_sim_ws20201/python')
import numpy as np
n = 27
molp = [1.00000000e-05, 1.19377664e-05, 1.42510267e-05, 1.70125428e-05,2.03091762e-05, 2.42446202e-05, 2.89426612e-05, 3.45510729e-05,4.12462638e-05, 4.92388263e-05, 5.87801607e-05, 7.01703829e-05,8.37677640e-05, 1.00000000e-04, 1.19377664e-04, 1.42510267e-04,1.70125428e-04, 2.03091762e-04, 2.42446202e-04, 2.89426612e-04,3.45510729e-04, 4.12462638e-04, 4.92388263e-04, 5.87801607e-04,7.01703829e-04, 8.37677640e-04, 1.00000000e-03]
RW = np.zeros((5,n))
RW[0,:]=[3.45253165e-06, 3.10722089e-06, 2.67791968e-06, 1.15162614e-05,1.48470702e-05, 6.11407672e-06, 2.37161460e-05, 3.38163944e-05,1.14327380e-05, 3.85325691e-05, 4.11267762e-05, 3.74246884e-05,4.74887502e-05, 4.60817289e-05, 4.75068817e-05, 5.85990428e-05,5.40764168e-05, 4.55168706e-05, 7.06244741e-05, 8.41243633e-05,8.79901411e-05, 9.04361203e-05, 8.51748266e-05, 1.07832620e-04,1.34058226e-04, 1.49946691e-04, 1.50928243e-04]
RW[1,:]=[1.64317518e-05, 3.94154730e-07, 1.71084934e-06, 4.60462489e-06,5.56859825e-06, 4.11793631e-06, 1.32599722e-05, 3.45409042e-05,1.83445642e-05, 3.82515302e-05, 4.45786034e-05, 3.85812519e-05,4.43002139e-05, 5.14191321e-05, 4.74302060e-05, 5.99538218e-05,5.25663232e-05, 4.34706605e-05, 7.15748526e-05, 8.19478402e-05,8.77497158e-05, 9.04652005e-05, 8.21728284e-05, 1.07074124e-04,1.33777235e-04, 1.50524166e-04, 1.44689710e-04]
RW[2,:]=[8.84066204e-07, 1.63485334e-06, 8.07103470e-06, 1.34239254e-05,3.79927639e-06, 2.11158001e-05, 2.92196256e-05, 3.71003132e-05,2.12442458e-05, 3.33456501e-05, 4.28779250e-05, 4.20309538e-05,4.49815061e-05, 4.75295125e-05, 4.76798608e-05, 6.05456072e-05,5.14189116e-05, 4.51821922e-05, 7.23315143e-05, 8.36701976e-05,8.78464444e-05, 9.01972241e-05, 9.04669728e-05, 1.08276812e-04,1.34749848e-04, 1.47085524e-04, 1.50151782e-04]
RW[3,:]=[1.21166593e-06, 4.04351940e-06, 2.11129493e-06, 1.09394595e-05,5.55071420e-06, 9.30348921e-06, 2.18618673e-05, 2.12811301e-08,3.21015333e-05, 3.75430387e-05, 4.29746546e-05, 3.67246065e-05,4.14175185e-05, 4.77602398e-05, 4.34086938e-05, 5.72924860e-05,4.87868467e-05, 4.48343098e-05, 7.18010781e-05, 8.26344826e-05,8.57109849e-05, 9.35746234e-05, 8.89697685e-05, 1.08349765e-04,1.33962079e-04, 1.49257273e-04, 1.53971958e-04]
RW[4,:]=[1.62997640e-05, 4.05261142e-06, 5.58206776e-06, 6.50918377e-06,4.14838132e-06, 2.33383378e-05, 2.23781302e-05, 1.01120242e-05,1.55425566e-05, 1.34971989e-05, 4.28624530e-05, 3.99314220e-05,3.20382618e-05, 5.65525805e-06, 4.54344939e-05, 5.41103696e-05,5.18458980e-05, 3.56672157e-05, 6.98260896e-05, 8.27282749e-05,8.74889766e-05, 9.20130520e-05, 8.78314509e-05, 1.09226918e-04,1.34415051e-04, 1.50566839e-04, 1.50133588e-04]
RWA = np.mean(RW,axis=0)
print(RWA)

from resonance_width import plot_res_widths,multi_resonance_width_fit
fig = plot_res_widths(RWA,molp)
fig.savefig('averaged resonance widths.png')
